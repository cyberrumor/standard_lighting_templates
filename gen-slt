#!/usr/bin/env python3
import textwrap
from collections import defaultdict
from enum import (
    auto,
    StrEnum,
)
from dataclasses import dataclass
from pathlib import Path
from typing import Iterable

# Docs:
# https://ck.uesp.net/wiki/Lighting_Template
# Note that Specular, Fresnel Power, and Ambient don't impact the scene at all.


# How many units until geometry is clipped out of the scene.
# Both 0 and 1 disable this kind of clipping. Disable that shit
# so the walls don't disappear and whatnot.
CLIP_DIST = 0

# Color of directional ambient lighting
# 13 is good for linear lighting.
# 25 is good for no linear lighting.
DALC_MAX = 25
DALC_MIN = DALC_MAX

# This is a light that impacts the entire cell. It is used to simulate bounced light.
# If you set them all to 255 and everything else to black, everything looks like dogshit.
# At least they're getting used, I guess. This comes from the top down. I noticed a bug
# where you can turn these off by setting them both to zero, but if you set both small
# non-zero values like 2, the most dim area will be more like 25 than 2. Maybe an issue
# with linear lighting?
DIRECTIONAL_COLOR = 0
DIRECTIONAL_FADE = 0

# This is completely unused by the game, but is used in the creation kit.
AMBIENT = 0
# This is completely unused by the game, never fully implemented by Bethesda.
SPECULAR = 0

# Color of fog.
FOG_FADE = 0

# How many units away from player camera before fog starts to show up.
# Best to set this in case disabling fog doesn't work for some reason.
FOG_NEAR = 100_000

# The distance where the fog maxes out. If your max fog power is less
# than one, the distance where you reach your maximum fog value will be
# shorter than this.
FOG_FAR = 1_000_000

# The power of the fog (between 0 and 1). The lower this value is,
# the quicker the fog will show up. This should be set to 1 so the
# values from FOG_NEAR and FOG_FAR actually get used verbatim.
FOG_POW = 1

AVAILABLE_FLAGS = [
    "ambientcolor",
    "clipdistance",
    "directionalcolor",
    "directionalfade",
    "directionalrotation",
    "fogcolor",
    "fogfar",
    "fogmax",
    "fognear",
    "fogpower",
    "lightfadedistances",
]

LIGHTING_TEMPLATE = "StandardLightingTemplates.esp|000801"
INHERIT_FLAGS = [
    # fogmax is the maximum amount the fog can impact the scene.
    # It's represented as a percent from 0 to 1. 0 disables fog.
    # We can't set this with SkyPatcher so we must inherit.
    "fogmax",
    "directionalrotation",
    "lightfadedistances",
]

# Stuff we want to set ourselves.
NO_INHERIT_FLAGS = {
    # ambientcolor itself does nothing but let you automatically set DALC via a button in the CK.
    # We have to inherit it to be able to override DALC though.
    "ambientcolor": (
        f"ambientRed={AMBIENT}:ambientGreen={AMBIENT}:ambientBlue={AMBIENT}:"
        + f"directionalAmbientXMinRed={DALC_MIN}:directionalAmbientXMinGreen={DALC_MIN}:directionalAmbientXMinBlue={DALC_MIN}:"
        + f"directionalAmbientXMaxRed={DALC_MAX}:directionalAmbientXMaxGreen={DALC_MAX}:directionalAmbientXMaxBlue={DALC_MAX}:"
        + f"directionalAmbientYMinRed={DALC_MIN}:directionalAmbientYMinGreen={DALC_MIN}:directionalAmbientYMinBlue={DALC_MIN}:"
        + f"directionalAmbientYMaxRed={DALC_MAX}:directionalAmbientYMaxGreen={DALC_MAX}:directionalAmbientYMaxBlue={DALC_MAX}:"
        + f"directionalAmbientZMinRed={DALC_MIN}:directionalAmbientZMinGreen={DALC_MIN}:directionalAmbientZMinBlue={DALC_MIN}:"
        + f"directionalAmbientZMaxRed={DALC_MAX}:directionalAmbientZMaxGreen={DALC_MAX}:directionalAmbientZMaxBlue={DALC_MAX}:"
        + f"directionalAmbientSpecularRed={SPECULAR}:directionalAmbientSpecularGreen={SPECULAR}:directionalAmbientSpecularBlue={SPECULAR}"
    ),
    "clipdistance": f"clipDist={CLIP_DIST}",
    "directionalcolor": f"directionalRed={DIRECTIONAL_COLOR}:directionalGreen={DIRECTIONAL_COLOR}:directionalBlue={DIRECTIONAL_COLOR}",
    "directionalfade": f"directionalFade={DIRECTIONAL_FADE}",
    "fogcolor": f"fogColorNearRed={FOG_FADE}:fogColorNearGreen={FOG_FADE}:fogColorNearBlue={FOG_FADE}",
    "fogfar": f"fogFar={FOG_FAR}",
    "fognear": f"fogNear={FOG_NEAR}",
    "fogpower": f"fogPower={FOG_POW}",
}

# Make sure we're specifying every available flag.
for flag in AVAILABLE_FLAGS:
    assert flag in INHERIT_FLAGS or flag in NO_INHERIT_FLAGS, (
        f"{flag} was not specified to be inherited or overridden"
    )

# Make sure we're not doubling up on flags.
for flag in INHERIT_FLAGS:
    assert flag not in NO_INHERIT_FLAGS, (
        f"{flag} was in INHERIT_FLAGS and NO_INHERIT_FLAGS. You can only use one or the other."
    )


SUPPORTED_PLUGINS = [file.name.rstrip("_Cells.csv") for file in Path("Cells").iterdir()]


class InteriorType(StrEnum):
    # caves, mines, etc
    DUNGEON_CAVE = auto()
    DUNGEON_DWEMER = auto()
    DUNGEON_FORT = auto()
    DUNGEON_ICE = auto()
    DUNGEON_UNDEAD = auto()
    # Almost all civilized interiors.
    CITY = auto()
    # sewers, prisons, cisterns, halls of the dead, warrens, abandoned buildings,
    # haunted passages, thieves guild HQ, Dark Brotherhood HQ, Dawnguard HQ.
    UNDERCITY = auto()
    MISC = auto()


INTERIOR_MAP = {
    "ARTHLALFarmhouse": InteriorType.CITY,
    "AbandonedPrison01": InteriorType.UNDERCITY,
    "AbandonedShackInterior": InteriorType.UNDERCITY,
    "Alftand01": InteriorType.DUNGEON_DWEMER,
    "Alftand02": InteriorType.DUNGEON_DWEMER,
    "AlftandZCell": InteriorType.DUNGEON_DWEMER,
    "Angarvunde01": InteriorType.DUNGEON_UNDEAD,
    "Angarvunde02": InteriorType.DUNGEON_UNDEAD,
    "Angarvunde03": InteriorType.DUNGEON_UNDEAD,
    "AngasMillAerisHouse": InteriorType.CITY,
    "AngasMillCommonHouse": InteriorType.CITY,
    "AnisesCabin01": InteriorType.UNDERCITY,
    "Ansilvund01": InteriorType.DUNGEON_UNDEAD,
    "Ansilvund02": InteriorType.DUNGEON_UNDEAD,
    "Avanchnzel01": InteriorType.DUNGEON_DWEMER,
    "Avanchnzel02": InteriorType.DUNGEON_DWEMER,
    "Avanchnzel03": InteriorType.DUNGEON_DWEMER,
    "AzuraVoiceCell": InteriorType.MISC,
    "AzurasStarInterior01": InteriorType.MISC,
    "BSKGoblins": InteriorType.MISC,
    "BSKQADiseases": InteriorType.MISC,
    "BSKWarehouseCrafting": InteriorType.MISC,
    "BYOHHouse1Falkreath": InteriorType.CITY,
    "BYOHHouse1FalkreathBasement": InteriorType.UNDERCITY,
    "BYOHHouse2Hjaalmarch": InteriorType.CITY,
    "BYOHHouse2HjaalmarchBasement": InteriorType.UNDERCITY,
    "BYOHHouse3Pale": InteriorType.CITY,
    "BYOHHouse3PaleBasement": InteriorType.UNDERCITY,
    "BattleBornFarm": InteriorType.CITY,
    "BilegulchMine": InteriorType.DUNGEON_CAVE,
    "BlackBriarLodge01": InteriorType.CITY,
    "BlackreachSewer01": InteriorType.UNDERCITY,
    "BlackreachZCell08": InteriorType.DUNGEON_DWEMER,
    "BlackreachZCell10": InteriorType.DUNGEON_DWEMER,
    "BlackreachZcell01": InteriorType.DUNGEON_DWEMER,
    "BlackreachZcell02": InteriorType.DUNGEON_DWEMER,
    "BlackreachZcell03": InteriorType.DUNGEON_DWEMER,
    "BlackreachZcell04": InteriorType.DUNGEON_DWEMER,
    "BlackreachZcell05": InteriorType.DUNGEON_DWEMER,
    "BlackreachZcell06": InteriorType.DUNGEON_DWEMER,
    "BlackreachZcell07": InteriorType.DUNGEON_DWEMER,
    "BleakFallsBarrow01": InteriorType.DUNGEON_UNDEAD,
    "BleakFallsBarrow02": InteriorType.DUNGEON_UNDEAD,
    "BleakcoastCave01": InteriorType.DUNGEON_ICE,
    "BlindCliffCave01": InteriorType.DUNGEON_CAVE,
    "BloodletThrone01": InteriorType.DUNGEON_FORT,
    "BluePalaceWing01": InteriorType.UNDERCITY,
    "BonechillPassage01": InteriorType.DUNGEON_ICE,
    "BoulderfallCave01": InteriorType.DUNGEON_CAVE,
    "BrandyMugFarm": InteriorType.CITY,
    "Brinehammer01": InteriorType.MISC,
    "BrittleShinPass01": InteriorType.DUNGEON_CAVE,
    "BrokenFangCave01": InteriorType.DUNGEON_CAVE,
    "BrokenHelmHollow01": InteriorType.DUNGEON_CAVE,
    "BrokenOarGrotto01": InteriorType.DUNGEON_CAVE,
    "BrokenTowerRedoubt01": InteriorType.DUNGEON_FORT,
    "BrokenTowerRedoubt02": InteriorType.DUNGEON_FORT,
    "BronzeWaterCave": InteriorType.DUNGEON_CAVE,
    "BroodCavern01": InteriorType.DUNGEON_CAVE,
    "BrucasLeapRedoubt01": InteriorType.DUNGEON_CAVE,
    "Bthardamz01": InteriorType.DUNGEON_DWEMER,
    "Bthardamz01a": InteriorType.DUNGEON_DWEMER,
    "Bthardamz01b": InteriorType.DUNGEON_DWEMER,
    "Bthardamz02": InteriorType.DUNGEON_DWEMER,
    "Bthardamz02a": InteriorType.DUNGEON_DWEMER,
    "Bthardamz03": InteriorType.DUNGEON_DWEMER,
    "CRFBarleydarkFarmInterior": InteriorType.CITY,
    "CRFFrostRiverHenrikHouse": InteriorType.CITY,
    "CRFFrostRiverMeadery": InteriorType.MISC,
    "CRFFrostRiverRogensHouse": InteriorType.CITY,
    "CRFHeljarchenApothecary": InteriorType.MISC,
    "CRFHeljarchenBlacksmith": InteriorType.MISC,
    "CRFHeljarchenHeigensHouse": InteriorType.CITY,
    "CRFHeljarchenJensHouse": InteriorType.CITY,
    "CRFIrontreeMillTrilfsHouse": InteriorType.CITY,
    "CRFStonehillsAleucHouse": InteriorType.CITY,
    "CRFStonehillsArgiFarseersHouse": InteriorType.CITY,
    "CRFStonehillsGesturHouse": InteriorType.CITY,
    "CRFStonehillsTalibHouse": InteriorType.CITY,
    "CRFWhiterunMaidenLoomManor": InteriorType.CITY,
    "CRFWhiterunWintersandManorHouse": InteriorType.CITY,
    "CWGuardTemplates": InteriorType.MISC,
    "CWQuartermasterContainers": InteriorType.MISC,
    "CYRAleswellCrextusResidence": InteriorType.MISC,
    "CYRAleswellFalegusResidence": InteriorType.MISC,
    "CYRAleswellInn": InteriorType.CITY,
    "CYRAleswellMathiasEndieriHouse": InteriorType.CITY,
    "CYRAleswellUmogDarSeelHouse": InteriorType.CITY,
    "CYRAnga": InteriorType.MISC,
    "CYRAnvilCathedral": InteriorType.MISC,
    "CYRApplewatchAebondsHouse": InteriorType.CITY,
    "CYRApplewatchBenuniAlfenasHouse": InteriorType.CITY,
    "CYRApplewatchGergusMalumeasHouse": InteriorType.CITY,
    "CYRArrowShaftCaverns01": InteriorType.DUNGEON_CAVE,
    "CYRArrowShaftCaverns02": InteriorType.DUNGEON_CAVE,
    "CYRAyleidRuinCh22": InteriorType.MISC,
    "CYRBawn01": InteriorType.MISC,
    "CYRBawn02": InteriorType.MISC,
    "CYRBawn03": InteriorType.MISC,
    "CYRBeldaburo": InteriorType.MISC,
    "CYRBeldaburoAnga": InteriorType.MISC,
    "CYRBelletorFolly": InteriorType.MISC,
    "CYRBelletorFollyMine": InteriorType.DUNGEON_CAVE,
    "CYRBleakMine01": InteriorType.DUNGEON_CAVE,
    "CYRBlueRiverDummyCell": InteriorType.MISC,
    "CYRBorealStoneCave": InteriorType.DUNGEON_CAVE,
    "CYRBravilCathedral": InteriorType.MISC,
    "CYRBravilInterior01": InteriorType.MISC,
    "CYRBravilInterior02": InteriorType.MISC,
    "CYRBravilInterior03": InteriorType.MISC,
    "CYRBravilInterior04A": InteriorType.MISC,
    "CYRBravilInterior04B": InteriorType.MISC,
    "CYRBravilInterior05": InteriorType.MISC,
    "CYRBravilInterior06A": InteriorType.MISC,
    "CYRBravilInterior06B": InteriorType.MISC,
    "CYRBravilInterior07": InteriorType.MISC,
    "CYRBravilInterior08": InteriorType.MISC,
    "CYRBravilInterior09": InteriorType.MISC,
    "CYRBravilInterior10": InteriorType.MISC,
    "CYRBravilInterior11": InteriorType.MISC,
    "CYRBravilInterior12A": InteriorType.MISC,
    "CYRBravilInterior12B": InteriorType.MISC,
    "CYRBravilInterior13A": InteriorType.MISC,
    "CYRBravilInterior13B": InteriorType.MISC,
    "CYRBravilInterior14": InteriorType.MISC,
    "CYRBravilInterior15": InteriorType.MISC,
    "CYRBravilInterior16": InteriorType.MISC,
    "CYRBravilInterior17": InteriorType.MISC,
    "CYRBravilInterior18": InteriorType.MISC,
    "CYRBravilInterior19A": InteriorType.MISC,
    "CYRBravilInterior19B": InteriorType.MISC,
    "CYRBravilInterior20": InteriorType.MISC,
    "CYRBravilInterior21A": InteriorType.MISC,
    "CYRBravilInterior21B": InteriorType.MISC,
    "CYRBravilInterior22": InteriorType.MISC,
    "CYRBravilInterior23A": InteriorType.MISC,
    "CYRBravilInterior23B": InteriorType.MISC,
    "CYRBravilInterior24A": InteriorType.MISC,
    "CYRBravilInterior24B": InteriorType.MISC,
    "CYRBravilInterior25": InteriorType.MISC,
    "CYRBravilInterior26": InteriorType.MISC,
    "CYRBravilInterior27": InteriorType.MISC,
    "CYRBravilInterior28": InteriorType.MISC,
    "CYRBravilInterior29": InteriorType.MISC,
    "CYRBravilInterior30A": InteriorType.MISC,
    "CYRBravilInterior30B": InteriorType.MISC,
    "CYRBravilInterior31": InteriorType.MISC,
    "CYRBravilInterior32": InteriorType.MISC,
    "CYRBreakNeckCave02": InteriorType.DUNGEON_CAVE,
    "CYRBreakneckCave01": InteriorType.DUNGEON_CAVE,
    "CYRBrightRubyFarm": InteriorType.CITY,
    "CYRBrinaCrossInterior01": InteriorType.MISC,
    "CYRBrinaCrossInterior02": InteriorType.MISC,
    "CYRBrinaCrossInterior03": InteriorType.MISC,
    "CYRBrinaCrossInterior04": InteriorType.MISC,
    "CYRBrinaCrossInterior05": InteriorType.MISC,
    "CYRBrinaCrossInterior06": InteriorType.MISC,
    "CYRBrinaCrossInterior07": InteriorType.MISC,
    "CYRBrumaACutAbove": InteriorType.MISC,
    "CYRBrumaAlbeciusJucanisHouse": InteriorType.CITY,
    "CYRBrumaAnanrilsHouse": InteriorType.CITY,
    "CYRBrumaBasementAlbecius": InteriorType.UNDERCITY,
    "CYRBrumaBasementPlayerHouse": InteriorType.UNDERCITY,
    "CYRBrumaBasementRenod": InteriorType.UNDERCITY,
    "CYRBrumaBasementSellus": InteriorType.UNDERCITY,
    "CYRBrumaBotramtheHammersHouse": InteriorType.CITY,
    "CYRBrumaCastleBarracks": InteriorType.MISC,
    "CYRBrumaCastleDungeon": InteriorType.MISC,
    "CYRBrumaCastleGreatHall": InteriorType.MISC,
    "CYRBrumaCastleGuestWing": InteriorType.MISC,
    "CYRBrumaCastleLordsManor": InteriorType.CITY,
    "CYRBrumaCastleServiceHall": InteriorType.MISC,
    "CYRBrumaCathedralofStMartin": InteriorType.MISC,
    "CYRBrumaCaverns": InteriorType.DUNGEON_CAVE,
    "CYRBrumaChapelHall": InteriorType.MISC,
    "CYRBrumaChapelUndercroft": InteriorType.MISC,
    "CYRBrumaCondemnedHouse": InteriorType.CITY,
    "CYRBrumaFF09DummyCell": InteriorType.MISC,
    "CYRBrumaFightersGuild": InteriorType.MISC,
    "CYRBrumaFightersGuildBasement": InteriorType.UNDERCITY,
    "CYRBrumaGalarynnsHouse": InteriorType.CITY,
    "CYRBrumaGryfardPetonsHouse": InteriorType.CITY,
    "CYRBrumaHaraldBurdssonsHouse": InteriorType.CITY,
    "CYRBrumaIceWindTraders": InteriorType.MISC,
    "CYRBrumaInterior03": InteriorType.MISC,
    "CYRBrumaJerallViewBath": InteriorType.MISC,
    "CYRBrumaJerallViewInn": InteriorType.CITY,
    "CYRBrumaJerallViewInnBasement": InteriorType.UNDERCITY,
    "CYRBrumaNorthernArms": InteriorType.MISC,
    "CYRBrumaRenodsHouse": InteriorType.CITY,
    "CYRBrumaSellusPreliusHouse": InteriorType.CITY,
    "CYRBrumaShack01LeoAndBaliusHouse": InteriorType.CITY,
    "CYRBrumaShack02TedralsHouse": InteriorType.CITY,
    "CYRBrumaShack03": InteriorType.CITY,
    "CYRBrumaShack04ArilusHouse": InteriorType.CITY,
    "CYRBrumaShack05RiljasHouse": InteriorType.CITY,
    "CYRBrumaShack06": InteriorType.CITY,
    "CYRBrumaShack07EdwarinsHouse": InteriorType.CITY,
    "CYRBrumaSilverPlowHouse": InteriorType.CITY,
    "CYRBrumaStenarCenosHouse": InteriorType.CITY,
    "CYRBrumaSynodBasement": InteriorType.UNDERCITY,
    "CYRBrumaSynodConclave": InteriorType.MISC,
    "CYRBrumaTheRestfulWatchman": InteriorType.MISC,
    "CYRBrumaWhitePineLodge": InteriorType.MISC,
    "CYRBrumaWildeyeStables": InteriorType.MISC,
    "CYRCLoudRulerTempleArmory": InteriorType.MISC,
    "CYRCapeBawnLighthouse": InteriorType.DUNGEON_ICE,
    "CYRCapstoneCave": InteriorType.DUNGEON_CAVE,
    "CYRCeyatatar": InteriorType.MISC,
    "CYRCeyatatar02Gorigarlas": InteriorType.MISC,
    "CYRCheydinhalCathedral": InteriorType.MISC,
    "CYRChorrolCathedral": InteriorType.MISC,
    "CYRCloudRulerTemple": InteriorType.MISC,
    "CYRCloudRulerTempleEastWing": InteriorType.MISC,
    "CYRCloudRulerTempleWestWing": InteriorType.MISC,
    "CYRCloudTopLookout": InteriorType.MISC,
    "CYRCloudTopLookoutBasement": InteriorType.UNDERCITY,
    "CYRCrowhaven": InteriorType.MISC,
    "CYRCrowhavenBurialHalls": InteriorType.MISC,
    "CYRCrumblingMine": InteriorType.DUNGEON_CAVE,
    "CYRDirichKeepFarmhouse": InteriorType.CITY,
    "CYRDunbarrowcove": InteriorType.MISC,
    "CYRDzonotCave": InteriorType.DUNGEON_CAVE,
    "CYREchoCave01": InteriorType.DUNGEON_CAVE,
    "CYRFarmInt03Warehouse": InteriorType.CITY,
    "CYRFingerbowlcave01": InteriorType.MISC,
    "CYRFingerbowlcave02": InteriorType.MISC,
    "CYRFingerbowlcaveDUPLICATE002": InteriorType.MISC,
    "CYRFingerbowlcaveDUPLICATE003": InteriorType.MISC,
    "CYRForesterOutpostForestMountainInterior01": InteriorType.MISC,
    "CYRFortAurus01": InteriorType.DUNGEON_FORT,
    "CYRFortAurus02": InteriorType.DUNGEON_FORT,
    "CYRFortCaractacus01": InteriorType.DUNGEON_FORT,
    "CYRFortColdcorn01": InteriorType.DUNGEON_FORT,
    "CYRFortColdcorn02": InteriorType.DUNGEON_FORT,
    "CYRFortCutpurse": InteriorType.DUNGEON_FORT,
    "CYRFortCutpurseJail": InteriorType.DUNGEON_FORT,
    "CYRFortCutpurseTower": InteriorType.DUNGEON_FORT,
    "CYRFortFerrus01": InteriorType.DUNGEON_FORT,
    "CYRFortFerrus02": InteriorType.DUNGEON_FORT,
    "CYRFortGrief01": InteriorType.DUNGEON_FORT,
    "CYRFortGrief02": InteriorType.DUNGEON_FORT,
    "CYRFortGriefDUPLICATE002": InteriorType.DUNGEON_FORT,
    "CYRFortHomestead": InteriorType.DUNGEON_FORT,
    "CYRFortHorunn01": InteriorType.DUNGEON_FORT,
    "CYRFortHorunn02": InteriorType.DUNGEON_FORT,
    "CYRFortHorunn03": InteriorType.DUNGEON_FORT,
    "CYRFortPalePass": InteriorType.DUNGEON_FORT,
    "CYRFortPalePassCaptainsQuarters": InteriorType.DUNGEON_FORT,
    "CYRFortPalePassPrison": InteriorType.DUNGEON_FORT,
    "CYRFortPalePassSubstructure": InteriorType.DUNGEON_FORT,
    "CYRFortRayles01": InteriorType.DUNGEON_FORT,
    "CYRFortStrand01": InteriorType.DUNGEON_FORT,
    "CYRFortStrand02": InteriorType.DUNGEON_FORT,
    "CYRFreezewindHollow": InteriorType.MISC,
    "CYRFrostCragSpire": InteriorType.MISC,
    "CYRFrostCragSpireTower": InteriorType.MISC,
    "CYRFrostCragSpireVault": InteriorType.MISC,
    "CYRFrostfireGlade01": InteriorType.MISC,
    "CYRFrostfireGlade02": InteriorType.MISC,
    "CYRFrostironmine01": InteriorType.MISC,
    "CYRFrostironmine02": InteriorType.MISC,
    "CYRFrozenGrotto": InteriorType.MISC,
    "CYRGautierreManor": InteriorType.CITY,
    "CYRGautierreManorBasement": InteriorType.UNDERCITY,
    "CYRGnollPass01": InteriorType.MISC,
    "CYRGonterFarm": InteriorType.CITY,
    "CYRGotshawinn": InteriorType.MISC,
    "CYRGreenwoodAfersHouse": InteriorType.CITY,
    "CYRGreenwoodMeadery": InteriorType.MISC,
    "CYRGroBarshnugFarm01": InteriorType.CITY,
    "CYRGroBarshnugFarm02": InteriorType.CITY,
    "CYRGuttedMine": InteriorType.DUNGEON_CAVE,
    "CYRHauntedMine": InteriorType.DUNGEON_CAVE,
    "CYRHjaltisRefuge": InteriorType.MISC,
    "CYRJerallHuntersShack": InteriorType.CITY,
    "CYRJerallHuntersShackDestroyed": InteriorType.UNDERCITY,
    "CYRKvatchAldmeriJusticiaryHall": InteriorType.CITY,
    "CYRKvatchAlovFamilyBrewers": InteriorType.CITY,
    "CYRKvatchAlovFamilyBrewersDistillery": InteriorType.CITY,
    "CYRKvatchAssiriDaroandHijharisHouse": InteriorType.CITY,
    "CYRKvatchAuricAttire": InteriorType.CITY,
    "CYRKvatchBigBoronsHouse": InteriorType.CITY,
    "CYRKvatchBookstore02OLD": InteriorType.CITY,
    "CYRKvatchBookstoreOLD": InteriorType.CITY,
    "CYRKvatchCastleCountsQuarters": InteriorType.CITY,
    "CYRKvatchCastleDiningHall": InteriorType.CITY,
    "CYRKvatchCastleDungeon": InteriorType.UNDERCITY,
    "CYRKvatchCastleGreatHall": InteriorType.CITY,
    "CYRKvatchCastleGuardQuarters": InteriorType.CITY,
    "CYRKvatchCastleGuestWing": InteriorType.CITY,
    "CYRKvatchChapelLivingQuarters": InteriorType.CITY,
    "CYRKvatchChapelUndercroft": InteriorType.CITY,
    "CYRKvatchChapelofAkatosh": InteriorType.CITY,
    "CYRKvatchCloudcrestBooks": InteriorType.CITY,
    "CYRKvatchCoastalCuriosities": InteriorType.CITY,
    "CYRKvatchEdinaPindersShack": InteriorType.CITY,
    "CYRKvatchEnclaveoftheHour": InteriorType.CITY,
    "CYRKvatchEnclaveoftheHourBasement": InteriorType.CITY,
    "CYRKvatchEsobelsHouse": InteriorType.CITY,
    "CYRKvatchFightersGuild": InteriorType.CITY,
    "CYRKvatchFireheartHotel": InteriorType.CITY,
    "CYRKvatchFireheartHotelBathhouse": InteriorType.CITY,
    "CYRKvatchGodsGiftOrphanage": InteriorType.CITY,
    "CYRKvatchHopeoftheForlorn": InteriorType.CITY,
    "CYRKvatchJH01": InteriorType.CITY,
    "CYRKvatchKeystoneCorner": InteriorType.CITY,
    "CYRKvatchLegionRecruitmentOffice": InteriorType.CITY,
    "CYRKvatchMelinaCrelussShack": InteriorType.CITY,
    "CYRKvatchRolfandFrayasHouse": InteriorType.CITY,
    "CYRKvatchSilverEyessBasement": InteriorType.CITY,
    "CYRKvatchSilverEyessHouse": InteriorType.CITY,
    "CYRKvatchTheBrassFlask": InteriorType.CITY,
    "CYRKvatchTheColovianChronicle": InteriorType.CITY,
    "CYRKvatchTheRightfulRemedy": InteriorType.CITY,
    "CYRKvatchTirensTannery": InteriorType.CITY,
    "CYRKvatchWindwalkerStables": InteriorType.CITY,
    "CYRKvatchWorkmansWares": InteriorType.CITY,
    "CYRKvatchWorkmansWaresBasement": InteriorType.CITY,
    "CYRKvatchinterior12": InteriorType.CITY,
    "CYRKvatchinterior13b": InteriorType.CITY,
    "CYRKvatchinterior14": InteriorType.CITY,
    "CYRKvatchinterior15": InteriorType.CITY,
    "CYRKvatchinterior24": InteriorType.CITY,
    "CYRKvatchinterior26": InteriorType.CITY,
    "CYRLaeniusFarm": InteriorType.CITY,
    "CYRLakesideRetreat": InteriorType.MISC,
    "CYRLakesideRetreatDUPLICATE001": InteriorType.MISC,
    "CYRLeyawinCathedral": InteriorType.MISC,
    "CYRLighthouseGoldCoast": InteriorType.DUNGEON_ICE,
    "CYRMaulochdurMines": InteriorType.DUNGEON_CAVE,
    "CYRMingoCave": InteriorType.DUNGEON_CAVE,
    "CYRMongrelsToothCave01": InteriorType.DUNGEON_CAVE,
    "CYRMongrelsToothCave02": InteriorType.DUNGEON_CAVE,
    "CYRMountainWatchAubertHouse": InteriorType.CITY,
    "CYRMountainWatchAvringErvigHouse": InteriorType.CITY,
    "CYRMountainWatchBunkhouse": InteriorType.MISC,
    "CYRMountainWatchZurikkiHouse": InteriorType.CITY,
    "CYRNagastaniAgeasel": InteriorType.MISC,
    "CYRNagastaniBuroseli": InteriorType.MISC,
    "CYRNagastaniCarasel": InteriorType.MISC,
    "CYRNagastaniCave": InteriorType.DUNGEON_CAVE,
    "CYRNagastaniCeysel": InteriorType.MISC,
    "CYRNagastaniGandrasel": InteriorType.MISC,
    "CYRNagastaniOblivion01": InteriorType.MISC,
    "CYRNagastaniSedorsel": InteriorType.MISC,
    "CYRNagastaniSewers": InteriorType.UNDERCITY,
    "CYRNagastaniSilaseli": InteriorType.MISC,
    "CYRNenalata01": InteriorType.MISC,
    "CYRNibenayValleyFisherShack": InteriorType.MISC,
    "CYRNiryastare": InteriorType.MISC,
    "CYRNiryastare02": InteriorType.MISC,
    "CYRNorthfringeSanctum01": InteriorType.MISC,
    "CYRNorthfringeSanctum02": InteriorType.MISC,
    "CYRNorthfringeSanctum03": InteriorType.MISC,
    "CYRNorthfringeSanctum04": InteriorType.MISC,
    "CYRNorthfringeSanctum05": InteriorType.MISC,
    "CYROutlawEndreCave": InteriorType.DUNGEON_CAVE,
    "CYRPellsGateInterior01BlacielAnHouse": InteriorType.CITY,
    "CYRPellsGateInterior02": InteriorType.MISC,
    "CYRPellsGateInterior03": InteriorType.MISC,
    "CYRPellsGateInterior04": InteriorType.MISC,
    "CYRPellsGateInterior05": InteriorType.MISC,
    "CYRPlunderedMine": InteriorType.DUNGEON_CAVE,
    "CYRRedRubyCave01": InteriorType.DUNGEON_CAVE,
    "CYRRedRubyCave02": InteriorType.DUNGEON_CAVE,
    "CYRRielle01": InteriorType.MISC,
    "CYRRielle02": InteriorType.MISC,
    "CYRRiversideShack": InteriorType.MISC,
    "CYRRiversideShackBasement": InteriorType.UNDERCITY,
    "CYRRobbersGlenCave01": InteriorType.DUNGEON_CAVE,
    "CYRSandstoneCavern01": InteriorType.DUNGEON_CAVE,
    "CYRSandstoneCavern02": InteriorType.DUNGEON_CAVE,
    "CYRSedor": InteriorType.MISC,
    "CYRSedorV201": InteriorType.MISC,
    "CYRSedorV202": InteriorType.MISC,
    "CYRSedorV203": InteriorType.MISC,
    "CYRSerpentsTrail01": InteriorType.MISC,
    "CYRSerpentsTrail02": InteriorType.MISC,
    "CYRSerpentsTrail03": InteriorType.MISC,
    "CYRShatteredMine": InteriorType.DUNGEON_CAVE,
    "CYRShatteredMine02": InteriorType.DUNGEON_CAVE,
    "CYRSilorn": InteriorType.MISC,
    "CYRSilorn02": InteriorType.MISC,
    "CYRSilorn03": InteriorType.MISC,
    "CYRSkingradCathedral": InteriorType.MISC,
    "CYRSmokeHoleCave01": InteriorType.DUNGEON_CAVE,
    "CYRSmokeHoleCave02": InteriorType.DUNGEON_CAVE,
    "CYRSnowstoneRest": InteriorType.MISC,
    "CYRTelepe01": InteriorType.MISC,
    "CYRTelepe02": InteriorType.MISC,
    "CYRTemplateImperialShipInterior": InteriorType.MISC,
    "CYRTemplateImperialShipInteriorRich": InteriorType.MISC,
    "CYRTheBeastsMaw": InteriorType.MISC,
    "CYRToadstoolHollow": InteriorType.MISC,
    "CYRTombOfUlnacHie01": InteriorType.DUNGEON_UNDEAD,
    "CYRTombOfUlnacHie02": InteriorType.DUNGEON_UNDEAD,
    "CYRTombOfUlnacHie03": InteriorType.DUNGEON_UNDEAD,
    "CYRTrumbe": InteriorType.MISC,
    "CYRUnderpall01": InteriorType.MISC,
    "CYRUnderpall02": InteriorType.MISC,
    "CYRUnderpall03": InteriorType.MISC,
    "CYRUnderpall04": InteriorType.MISC,
    "CYRUnderpall05": InteriorType.MISC,
    "CYRUnmarkedCave": InteriorType.DUNGEON_CAVE,
    "CYRVarando01": InteriorType.MISC,
    "CYRVarando02": InteriorType.MISC,
    "CYRVarando03": InteriorType.MISC,
    "CYRVilverin": InteriorType.MISC,
    "CYRVoteporixsTomb01": InteriorType.DUNGEON_UNDEAD,
    "CYRWICourierCell": InteriorType.MISC,
    "CYRWarehouseCrafting": InteriorType.MISC,
    "CYRWarehouseFurniture": InteriorType.MISC,
    "CYRWarehousePrefabs": InteriorType.MISC,
    "CYRWatersEdgeInterior01": InteriorType.MISC,
    "CYRWatersEdgeInterior02": InteriorType.MISC,
    "CYRWatersEdgeInterior03": InteriorType.MISC,
    "CYRWatersEdgeInterior04": InteriorType.MISC,
    "CYRWatersEdgeInterior05": InteriorType.MISC,
    "CYRWatersEdgeInterior06": InteriorType.MISC,
    "CYRWatersEdgeInteriorDUPLICATE002": InteriorType.MISC,
    "CYRWellappBanditMine": InteriorType.DUNGEON_CAVE,
    "CYRWeyeAlerioGurgesHouse": InteriorType.CITY,
    "CYRWeyeBastienAdrardHouse": InteriorType.CITY,
    "CYRWeyeDominitianFarm": InteriorType.CITY,
    "CYRWeyeDurashGraAgumHouse": InteriorType.CITY,
    "CYRWeyeEmberfootFarm": InteriorType.CITY,
    "CYRWeyeGeneralStore": InteriorType.MISC,
    "CYRWeyeGrennHouse": InteriorType.CITY,
    "CYRWeyeInterior04": InteriorType.MISC,
    "CYRWeyeMessalaFarm": InteriorType.CITY,
    "CYRWeyeVarnandHouse": InteriorType.CITY,
    "CYRWeyeWarehouseAux": InteriorType.MISC,
    "CYRWeyeWarehouseRumare": InteriorType.MISC,
    "CYRWeyeWawnetInn": InteriorType.CITY,
    "CYRtelmolkadish": InteriorType.MISC,
    "ChillfurrowFarm": InteriorType.CITY,
    "ChillwindDepths01": InteriorType.DUNGEON_CAVE,
    "CidhnaMine01": InteriorType.DUNGEON_CAVE,
    "CidhnaMine02": InteriorType.DUNGEON_CAVE,
    "CidhnaMine03": InteriorType.DUNGEON_CAVE,
    "ClearspringTarn01": InteriorType.MISC,
    "ColdRockPass01": InteriorType.DUNGEON_CAVE,
    "CrackedTuskKeep01": InteriorType.DUNGEON_FORT,
    "CrackedTuskKeep02": InteriorType.DUNGEON_FORT,
    "CragslaneCavern01": InteriorType.DUNGEON_CAVE,
    "CragwallowSlope01": InteriorType.DUNGEON_CAVE,
    "CronvangrHall01": InteriorType.DUNGEON_CAVE,
    "CronvangrHall02": InteriorType.DUNGEON_CAVE,
    "CrystaldriftCave01": InteriorType.DUNGEON_CAVE,
    "CustomHrotaCave": InteriorType.DUNGEON_CAVE,
    "CyrGarlasAgea": InteriorType.MISC,
    "CyrGarlasTure": InteriorType.MISC,
    "CyrSidewaysCave01": InteriorType.DUNGEON_CAVE,
    "CyrSidewaysCave02": InteriorType.DUNGEON_CAVE,
    "CyrSidewaysCave03": InteriorType.DUNGEON_CAVE,
    "CyrSilvertoothCaveV201": InteriorType.DUNGEON_CAVE,
    "CyrSilvertoothCaveV202": InteriorType.DUNGEON_CAVE,
    "DA14Interior": InteriorType.MISC,
    "DBMAirshipCabin": InteriorType.MISC,
    "DBMAyleidPocketRealm": InteriorType.MISC,
    "DBMDGArmory": InteriorType.MISC,
    "DBMDGArmoryEast": InteriorType.MISC,
    "DBMDGArmoryWest": InteriorType.MISC,
    "DBMDGDragonbornHall": InteriorType.MISC,
    "DBMDGEastExhibitHalls": InteriorType.MISC,
    "DBMDGHallofHeroes": InteriorType.MISC,
    "DBMDGHallofHeroesHaunted": InteriorType.MISC,
    "DBMDGHallofHeroesHeist": InteriorType.MISC,
    "DBMDGHallofSecrets": InteriorType.MISC,
    "DBMDGHallofSecretsBare": InteriorType.MISC,
    "DBMDGLibrary": InteriorType.MISC,
    "DBMDGNaturalScience": InteriorType.MISC,
    "DBMDGNaturalScienceHaunted": InteriorType.MISC,
    "DBMDGPlanetarium": InteriorType.MISC,
    "DBMDGSafehouse": InteriorType.MISC,
    "DBMDGSafehouseHaunted": InteriorType.MISC,
    "DBMDGStoreroom": InteriorType.MISC,
    "DBMDebugRoom": InteriorType.MISC,
    "DBMDeepholme": InteriorType.MISC,
    "DBMDragonsFall": InteriorType.MISC,
    "DBMDragonsFallDepths": InteriorType.MISC,
    "DBMDragonsFallSanctum": InteriorType.MISC,
    "DBMDregasVolarInt": InteriorType.MISC,
    "DBMEngelmannsRest": InteriorType.MISC,
    "DBMEngelmannsSanctuary": InteriorType.MISC,
    "DBMFieldStation01": InteriorType.MISC,
    "DBMFieldStation02": InteriorType.MISC,
    "DBMFieldStation03": InteriorType.MISC,
    "DBMFortPalePass": InteriorType.DUNGEON_FORT,
    "DBMFortPalePassStoreroom": InteriorType.DUNGEON_FORT,
    "DBMFortPalePassVaults": InteriorType.DUNGEON_FORT,
    "DBMFortPalePassWestTower": InteriorType.DUNGEON_FORT,
    "DBMGreenwallRuins": InteriorType.MISC,
    "DBMGuildhouse": InteriorType.MISC,
    "DBMJolgeirrBarrow": InteriorType.MISC,
    "DBMJournalDungeon01": InteriorType.MISC,
    "DBMMAASEAftlandAnnex": InteriorType.MISC,
    "DBMMAASEIrkDescent": InteriorType.MISC,
    "DBMMAASEIrkRefuge": InteriorType.MISC,
    "DBMMAASEXribAnnex": InteriorType.MISC,
    "DBMPalePassPassage": InteriorType.MISC,
    "DBMQA": InteriorType.MISC,
    "DBMQA2": InteriorType.MISC,
    "DBMRainsShelter": InteriorType.MISC,
    "DBMRavenRest": InteriorType.MISC,
    "DBMRkund01": InteriorType.DUNGEON_DWEMER,
    "DBMRkund02": InteriorType.DUNGEON_DWEMER,
    "DBMRkund03": InteriorType.DUNGEON_DWEMER,
    "DBMRkund04": InteriorType.DUNGEON_DWEMER,
    "DBMRkund05": InteriorType.DUNGEON_DWEMER,
    "DBMRkund06": InteriorType.DUNGEON_DWEMER,
    "DBMSagruunde": InteriorType.MISC,
    "DBMSanctum": InteriorType.MISC,
    "DBMSnowElfTemple": InteriorType.MISC,
    "DBMTrinimacTemple01": InteriorType.MISC,
    "DBMTrinimacTemple02": InteriorType.MISC,
    "DBMVQBromgolt": InteriorType.MISC,
    "DBMVQMzuhlac": InteriorType.MISC,
    "DBMVQStendarrsRefuge": InteriorType.MISC,
    "DBMVQWhiteBluffHideout": InteriorType.MISC,
    "DBMWaywardRest": InteriorType.MISC,
    "DBMWindcallerPassN": InteriorType.MISC,
    "DBMWindcallerPassS": InteriorType.MISC,
    "DLC1Arkngthamz01": InteriorType.MISC,
    "DLC1Bthalft01": InteriorType.DUNGEON_DWEMER,
    "DLC1DarkfallCave01": InteriorType.DUNGEON_CAVE,
    "DLC1DawnguardHQ01": InteriorType.UNDERCITY,
    "DLC1DimHollowCrypt01": InteriorType.DUNGEON_CAVE,
    "DLC1DimHollowCrypt02": InteriorType.DUNGEON_CAVE,
    "DLC1FalmerTemple01": InteriorType.MISC,
    "DLC1GlacialCrevice01": InteriorType.MISC,
    "DLC1HunterCave01": InteriorType.DUNGEON_CAVE,
    "DLC1HunterCave02": InteriorType.DUNGEON_CAVE,
    "DLC1HunterValleyCave01": InteriorType.DUNGEON_CAVE,
    "DLC1MolderingRuins01": InteriorType.MISC,
    "DLC1NPCHome": InteriorType.CITY,
    "DLC1RedwaterDen01": InteriorType.UNDERCITY,
    "DLC1RedwaterDen02": InteriorType.UNDERCITY,
    "DLC1Ruunvald01": InteriorType.DUNGEON_CAVE,
    "DLC1Ruunvald02": InteriorType.DUNGEON_CAVE,
    "DLC1SoulCairnReaperCell": InteriorType.DUNGEON_UNDEAD,
    "DLC1VampireCastleBossRoom": InteriorType.DUNGEON_UNDEAD,
    "DLC1VampireCastleDungeon01": InteriorType.DUNGEON_UNDEAD,
    "DLC1VampireCastleDungeon02": InteriorType.DUNGEON_UNDEAD,
    "DLC1VampireCastleGuildhall": InteriorType.UNDERCITY,
    "DLC1VampireCastleZCell1": InteriorType.DUNGEON_UNDEAD,
    "DLC1VampireCastleZCell2": InteriorType.DUNGEON_UNDEAD,
    "DLC1WarehouseAmbushes": InteriorType.MISC,
    "DLC1WarehousePrefabs": InteriorType.MISC,
    "DLC1zFalmerValley01": InteriorType.DUNGEON_ICE,
    "DLC1zFalmerValley02": InteriorType.DUNGEON_ICE,
    "DLC1zFalmerValley03": InteriorType.DUNGEON_ICE,
    "DLC1zFalmerValley04": InteriorType.DUNGEON_ICE,
    "DLC1zSoulCairn01": InteriorType.DUNGEON_UNDEAD,
    "DLC2AbandonedLodge": InteriorType.UNDERCITY,
    "DLC2AltarOfThrond01": InteriorType.MISC,
    "DLC2AshfallowCitadel01": InteriorType.DUNGEON_FORT,
    "DLC2Benkongerike01": InteriorType.DUNGEON_ICE,
    "DLC2Benkongerike02": InteriorType.DUNGEON_ICE,
    "DLC2BloodskalBarrow01": InteriorType.DUNGEON_UNDEAD,
    "DLC2BloodskalBarrow01a": InteriorType.DUNGEON_UNDEAD,
    "DLC2BloodskalBarrow02": InteriorType.DUNGEON_UNDEAD,
    "DLC2Book01Dungeon": InteriorType.MISC,
    "DLC2Book01DungeonA": InteriorType.MISC,
    "DLC2Book02DungeonNEW": InteriorType.MISC,
    "DLC2Book03Dungeon": InteriorType.MISC,
    "DLC2Book07Dungeon": InteriorType.MISC,
    "DLC2BristlebackCave01": InteriorType.DUNGEON_ICE,
    "DLC2BrokenTuskMine01": InteriorType.DUNGEON_CAVE,
    "DLC2CastleKarstaagRuins01": InteriorType.DUNGEON_ICE,
    "DLC2DamphallMine01": InteriorType.DUNGEON_CAVE,
    "DLC2DremoraShop": InteriorType.MISC,
    "DLC2Fahlbtharz01": InteriorType.DUNGEON_DWEMER,
    "DLC2Fahlbtharz02": InteriorType.DUNGEON_DWEMER,
    "DLC2Fahlbtharz03": InteriorType.DUNGEON_DWEMER,
    "DLC2Fahlbtharz04": InteriorType.DUNGEON_DWEMER,
    "DLC2FortFrostmoth01": InteriorType.DUNGEON_FORT,
    "DLC2Frossel01": InteriorType.DUNGEON_CAVE,
    "DLC2GlacialCave": InteriorType.DUNGEON_ICE,
    "DLC2GyldenhulBarrow01": InteriorType.DUNGEON_UNDEAD,
    "DLC2HarstradCave01": InteriorType.DUNGEON_CAVE,
    "DLC2HighpointTower01": InteriorType.DUNGEON_FORT,
    "DLC2HrodulfsHouse": InteriorType.CITY,
    "DLC2HrothmundsBarrow01": InteriorType.DUNGEON_CAVE,
    "DLC2Kagrumez01": InteriorType.DUNGEON_DWEMER,
    "DLC2KolbjornBarrow01": InteriorType.DUNGEON_UNDEAD,
    "DLC2MoesringPass01": InteriorType.MISC,
    "DLC2MoesringPass02DBM": InteriorType.MISC,
    "DLC2Nchardak00": InteriorType.DUNGEON_DWEMER,
    "DLC2Nchardak01": InteriorType.DUNGEON_DWEMER,
    "DLC2Nchardak02": InteriorType.DUNGEON_DWEMER,
    "DLC2Nchardak03": InteriorType.DUNGEON_DWEMER,
    "DLC2POIBookLevel01": InteriorType.MISC,
    "DLC2POIBookLevel02": InteriorType.MISC,
    "DLC2POIBookLevel03": InteriorType.MISC,
    "DLC2RRAbandonedBuilding": InteriorType.MISC,
    "DLC2RRAlorHouse": InteriorType.CITY,
    "DLC2RRBulwark": InteriorType.MISC,
    "DLC2RRBulwark02": InteriorType.MISC,
    "DLC2RRBulwarkCave": InteriorType.DUNGEON_CAVE,
    "DLC2RRCresciusHouse": InteriorType.CITY,
    "DLC2RRGloverMalloryHouse": InteriorType.CITY,
    "DLC2RRIenthFarm": InteriorType.CITY,
    "DLC2RRMorvaynManor": InteriorType.CITY,
    "DLC2RRMorvaynManorChambers": InteriorType.CITY,
    "DLC2RRMorvaynTomb": InteriorType.DUNGEON_UNDEAD,
    "DLC2RRSeverinHouse": InteriorType.CITY,
    "DLC2RRTemple": InteriorType.CITY,
    "DLC2RRTempleTomb": InteriorType.UNDERCITY,
    "DLC2RRTheRetchingNetch": InteriorType.CITY,
    "DLC2RRUlenTomb": InteriorType.DUNGEON_UNDEAD,
    "DLC2RieklingFurniture": InteriorType.MISC,
    "DLC2SVBaldorIronShapersHouse": InteriorType.CITY,
    "DLC2SVDeorsHouse": InteriorType.CITY,
    "DLC2SVEdlasHouse": InteriorType.CITY,
    "DLC2SVGreathall": InteriorType.MISC,
    "DLC2SVMorwensHouse": InteriorType.CITY,
    "DLC2SVOslafsHouse": InteriorType.CITY,
    "DLC2SVShamansHutInterior": InteriorType.MISC,
    "DLC2SVWulfWildbloodsHouse": InteriorType.CITY,
    "DLC2TelMithryn": InteriorType.CITY,
    "DLC2TelMithrynApothecary": InteriorType.CITY,
    "DLC2TelMithrynKitchen": InteriorType.CITY,
    "DLC2TelMithrynStewardsHouse": InteriorType.CITY,
    "DLC2TempleOfMiraak01": InteriorType.DUNGEON_UNDEAD,
    "DLC2TempleofMiraak02": InteriorType.DUNGEON_UNDEAD,
    "DLC2ThirskMeadHallInterior01": InteriorType.MISC,
    "DLC2VahloksTomb01": InteriorType.DUNGEON_UNDEAD,
    "DLC2WarehouseAmbushes": InteriorType.MISC,
    "DLC2WarehouseRieklings": InteriorType.MISC,
    "DLC2WarehouseSpiders": InteriorType.MISC,
    "DLC2WhiteRidgeBarrow01": InteriorType.DUNGEON_UNDEAD,
    "DLC2WhiteRidgeBarrow02": InteriorType.DUNGEON_UNDEAD,
    "DaintySload01": InteriorType.MISC,
    "DarkBrotherhoodSanctuary": InteriorType.UNDERCITY,
    "DarklightTower01": InteriorType.DUNGEON_FORT,
    "DarklightTower02": InteriorType.DUNGEON_FORT,
    "Darkshade01": InteriorType.DUNGEON_CAVE,
    "DarkwaterCrossingGoldenrockMine": InteriorType.DUNGEON_CAVE,
    "DarkwaterCrossingVernersHouse": InteriorType.CITY,
    "DawnstarBarracks": InteriorType.CITY,
    "DawnstarBarracksJail": InteriorType.UNDERCITY,
    "DawnstarBeitildsHouse": InteriorType.CITY,
    "DawnstarBrinasHouse": InteriorType.CITY,
    "DawnstarFrukisHouse": InteriorType.CITY,
    "DawnstarIrgnirsHouse": InteriorType.CITY,
    "DawnstarIronBreakerMine": InteriorType.DUNGEON_CAVE,
    "DawnstarLeigelfsHouse": InteriorType.CITY,
    "DawnstarMortarandPestle": InteriorType.CITY,
    "DawnstarQuicksilverMine": InteriorType.DUNGEON_CAVE,
    "DawnstarRustleifsHouse": InteriorType.CITY,
    "DawnstarSanctuary": InteriorType.UNDERCITY,
    "DawnstarSilussHouse": InteriorType.CITY,
    "DawnstarTheWhiteHall": InteriorType.CITY,
    "DawnstarWindpeakInn": InteriorType.CITY,
    "DeadCroneRock01": InteriorType.MISC,
    "DeadMensRespite01": InteriorType.DUNGEON_UNDEAD,
    "DeepwoodRedoubt01": InteriorType.DUNGEON_UNDEAD,
    "DragonBridgeFarm": InteriorType.CITY,
    "DragonBridgeFourShieldsTavern": InteriorType.CITY,
    "DragonBridgeHorgeirsHouse": InteriorType.CITY,
    "DragonBridgeLumberCamp": InteriorType.MISC,
    "DragonBridgePenitusOculatusOutpost": InteriorType.CITY,
    "DrelasCottage01": InteriorType.CITY,
    "DriftshadeSanctuary01": InteriorType.DUNGEON_FORT,
    "DriftshadeSanctuary02": InteriorType.DUNGEON_FORT,
    "DruadachRedoubt01": InteriorType.MISC,
    "DushnikhYalCellar": InteriorType.UNDERCITY,
    "DushnikhYalLonghouse": InteriorType.MISC,
    "DushnikhYalMine": InteriorType.DUNGEON_CAVE,
    "DuskglowCrevice01": InteriorType.DUNGEON_CAVE,
    "DustmansCairn01": InteriorType.DUNGEON_UNDEAD,
    "DustmansCairn02": InteriorType.DUNGEON_UNDEAD,
    "E3demoBleakFallsBarrow": InteriorType.DUNGEON_UNDEAD,
    "Elsweyr": InteriorType.MISC,
    "EmbershardMine01": InteriorType.DUNGEON_CAVE,
    "FaldarsTooth01": InteriorType.DUNGEON_FORT,
    "FalkreathBarracks": InteriorType.CITY,
    "FalkreathBarracksJail": InteriorType.UNDERCITY,
    "FalkreathCorpselightFarm": InteriorType.CITY,
    "FalkreathDeadMansDrink": InteriorType.CITY,
    "FalkreathDengeirsHall": InteriorType.CITY,
    "FalkreathGraveConcoctions": InteriorType.CITY,
    "FalkreathGrayPineGoods": InteriorType.CITY,
    "FalkreathHouseofArkay": InteriorType.CITY,
    "FalkreathJarlsLonghouse": InteriorType.CITY,
    "FalkreathLodsHouse": InteriorType.CITY,
    "FellglowKeep01": InteriorType.DUNGEON_FORT,
    "FellglowKeep02": InteriorType.DUNGEON_FORT,
    "FellglowKeep03": InteriorType.DUNGEON_FORT,
    "Folgunthur01": InteriorType.DUNGEON_UNDEAD,
    "Folgunthur02": InteriorType.DUNGEON_UNDEAD,
    "Forelhost01": InteriorType.DUNGEON_UNDEAD,
    "Forelhost02": InteriorType.DUNGEON_UNDEAD,
    "Forelhost03": InteriorType.DUNGEON_UNDEAD,
    "ForsakenCave01": InteriorType.DUNGEON_CAVE,
    "ForsakenCave02": InteriorType.DUNGEON_CAVE,
    "FortAmol01": InteriorType.DUNGEON_FORT,
    "FortAmol02": InteriorType.DUNGEON_FORT,
    "FortDunstad01": InteriorType.DUNGEON_FORT,
    "FortDunstad02": InteriorType.DUNGEON_FORT,
    "FortDunstad03": InteriorType.DUNGEON_FORT,
    "FortDunstad04": InteriorType.DUNGEON_FORT,
    "FortFellhammer01": InteriorType.DUNGEON_FORT,
    "FortFellhammer02": InteriorType.DUNGEON_FORT,
    "FortGreenwall01": InteriorType.DUNGEON_FORT,
    "FortGreenwall02": InteriorType.DUNGEON_FORT,
    "FortGreenwall03": InteriorType.DUNGEON_FORT,
    "FortGreenwall04": InteriorType.DUNGEON_FORT,
    "FortGreymoor01": InteriorType.DUNGEON_FORT,
    "FortGreymoor02": InteriorType.DUNGEON_FORT,
    "FortHraggstad01": InteriorType.DUNGEON_FORT,
    "FortHraggstad02": InteriorType.DUNGEON_FORT,
    "FortKastav01": InteriorType.DUNGEON_FORT,
    "FortKastav02": InteriorType.DUNGEON_FORT,
    "FortNeugrad01": InteriorType.DUNGEON_FORT,
    "FortNeugrad02": InteriorType.DUNGEON_FORT,
    "FortSnowhawk01": InteriorType.DUNGEON_FORT,
    "FortSnowhawk02": InteriorType.DUNGEON_FORT,
    "FortSungard01": InteriorType.DUNGEON_FORT,
    "FortSungard02": InteriorType.DUNGEON_FORT,
    "FortSungard03": InteriorType.DUNGEON_FORT,
    "FortSungard04": InteriorType.DUNGEON_FORT,
    "FortSungard05": InteriorType.DUNGEON_FORT,
    "FrostflowAbyss": InteriorType.MISC,
    "FrostflowLighthouse": InteriorType.DUNGEON_ICE,
    "FrostmereCrypt01": InteriorType.DUNGEON_UNDEAD,
    "GallowsRock01": InteriorType.DUNGEON_FORT,
    "GeirmundsHall01": InteriorType.DUNGEON_UNDEAD,
    "GlenmorilCoven01": InteriorType.DUNGEON_CAVE,
    "GloomboundMine01": InteriorType.DUNGEON_CAVE,
    "Gloomreach01": InteriorType.DUNGEON_CAVE,
    "Gloomreach02": InteriorType.DUNGEON_CAVE,
    "GoldenglowEstate01": InteriorType.CITY,
    "GoldenglowEstate02": InteriorType.CITY,
    "GoldenglowEstate03": InteriorType.CITY,
    "GoldenglowEstate04": InteriorType.CITY,
    "GraywinterWatch01": InteriorType.DUNGEON_CAVE,
    "GreywaterGrotto01": InteriorType.DUNGEON_CAVE,
    "GuldunRock01": InteriorType.MISC,
    "HaemarsShame01": InteriorType.DUNGEON_CAVE,
    "HaemarsShame02": InteriorType.DUNGEON_CAVE,
    "HagRockRedoubt01": InteriorType.DUNGEON_UNDEAD,
    "HagsEnd01": InteriorType.DUNGEON_UNDEAD,
    "HalfMoonMill": InteriorType.MISC,
    "HallOfTheVigilant01": InteriorType.MISC,
    "HalldirsCairn01": InteriorType.DUNGEON_UNDEAD,
    "HaltedStreamCamp01": InteriorType.MISC,
    "Harmugstahl01": InteriorType.DUNGEON_FORT,
    "HeartwoodMill": InteriorType.UNDERCITY,
    "HelgenHomestead": InteriorType.CITY,
    "HelgenKeep01": InteriorType.DUNGEON_FORT,
    "HelgenTheLostMansReprieve": InteriorType.MISC,
    "HelgenTorolfsMill": InteriorType.MISC,
    "HighGateRuins01": InteriorType.DUNGEON_UNDEAD,
    "HighGateRuins02": InteriorType.DUNGEON_UNDEAD,
    "HighGateRuins03": InteriorType.DUNGEON_UNDEAD,
    "HighHrothgar": InteriorType.CITY,
    "HillgrundsTomb01": InteriorType.DUNGEON_UNDEAD,
    "HlaaluFarm": InteriorType.CITY,
    "HoarfrostGrottoOLD": InteriorType.MISC,
    "HobsFallCave01": InteriorType.DUNGEON_ICE,
    "HollyfrostFarm": InteriorType.CITY,
    "HoneystrandGrove01": InteriorType.MISC,
    "HonningbrewMeadery01": InteriorType.MISC,
    "HonningbrewMeadery02": InteriorType.MISC,
    "HonningbrewMeadery03": InteriorType.MISC,
    "HunterShack": InteriorType.MISC,
    "Icerunner01": InteriorType.MISC,
    "IlinaltasDeep01": InteriorType.DUNGEON_FORT,
    "IlinaltasDeep02": InteriorType.DUNGEON_FORT,
    "Irkngthand01": InteriorType.DUNGEON_DWEMER,
    "Irkngthand02": InteriorType.DUNGEON_DWEMER,
    "Irkngthand03": InteriorType.DUNGON_DWEMER,
    "Irkngthand04": InteriorType.DUNGEON_DWEMER,
    "IronbindBarrow01": InteriorType.DUNGEON_UNDEAD,
    "IvarsteadFellstarFarm": InteriorType.CITY,
    "IvarsteadKlimmeksHouse": InteriorType.CITY,
    "IvarsteadVilemyrInn": InteriorType.CITY,
    "JaphetsFolly01": InteriorType.MISC,
    "JaphetsFolly02": InteriorType.MISC,
    "JerallViewInteriorTemplate": InteriorType.MISC,
    "Kagrenzel01": InteriorType.DUNGEON_DWEMER,
    "KarthwastenEnmonsHouse": InteriorType.CITY,
    "KarthwastenFennsGulchMine": InteriorType.DUNGEON_CAVE,
    "KarthwastenHall": InteriorType.MISC,
    "KarthwastenMinersBarracks": InteriorType.DUNGEON_CAVE,
    "KarthwastenSanuarachMine": InteriorType.DUNGEON_CAVE,
    "Katariah01": InteriorType.CITY,
    "KatlasFarm": InteriorType.CITY,
    "KilkreathRuins01": InteriorType.DUNGEON_UNDEAD,
    "KilkreathRuins02": InteriorType.DUNGEON_UNDEAD,
    "KilkreathRuins03": InteriorType.DUNGEON_UNDEAD,
    "KnifepointRidge01": InteriorType.MISC,
    "KolskeggrMine01": InteriorType.DUNGEON_CAVE,
    "KolskeggrMinePavosHouse": InteriorType.DUNGEON_CAVE,
    "Korvanjund01": InteriorType.DUNGEON_UNDEAD,
    "Korvanjund02": InteriorType.DUNGEON_UNDEAD,
    "Korvanjund03": InteriorType.DUNGEON_UNDEAD,
    "KynesgroveBraidwoodInn": InteriorType.CITY,
    "KynesgroveSteamscorchGullyMine": InteriorType.DUNGEON_CAVE,
    "Labyrinthian01": InteriorType.DUNGEON_UNDEAD,
    "Labyrinthian03": InteriorType.DUNGEON_UNDEAD,
    "LabyrinthianMaze": InteriorType.DUNGEON_UNDEAD,
    "LabyrinthianPriestSanctuary": InteriorType.DUNGEON_UNDEAD,
    "LargashburBasement": InteriorType.UNDERCITY,
    "LargashburShagrolsLonghouse": InteriorType.MISC,
    "LeftHandMine": InteriorType.DUNGEON_CAVE,
    "LeftHandMineDaighresHouse": InteriorType.DUNGEON_CAVE,
    "LeftHandMineMinersBarracks": InteriorType.DUNGEON_CAVE,
    "LeftHandMineSkaggisHouse": InteriorType.DUNGEON_CAVE,
    "LiarsRetreat01": InteriorType.DUNGEON_CAVE,
    "LoreiusFarmhouse": InteriorType.CITY,
    "LostEchoCave01": InteriorType.DUNGEON_CAVE,
    "LostKnifeHideout01": InteriorType.DUNGEON_CAVE,
    "LostKnifeHideout02": InteriorType.DUNGEON_CAVE,
    "LostProspectMine01": InteriorType.DUNGEON_CAVE,
    "LundsHut01": InteriorType.MISC,
    "MainMenuCell": InteriorType.MISC,
    "MalynVarenVoiceCell": InteriorType.MISC,
    "MarasEyePond01": InteriorType.DUNGEON_CAVE,
    "MarkarthAbandonedHouse": InteriorType.CITY,
    "MarkarthArnleifandSonsTradingCompany": InteriorType.CITY,
    "MarkarthEndonsHouse": InteriorType.CITY,
    "MarkarthGuardTower": InteriorType.CITY,
    "MarkarthHagsCure": InteriorType.CITY,
    "MarkarthHalloftheDead": InteriorType.UNDERCITY,
    "MarkarthNepossHouse": InteriorType.CITY,
    "MarkarthOgmundsHouse": InteriorType.CITY,
    "MarkarthShrineofTalos": InteriorType.CITY,
    "MarkarthSilverBloodInn": InteriorType.CITY,
    "MarkarthSmelterOverseersHouse": InteriorType.CITY,
    "MarkarthStableHouse": InteriorType.CITY,
    "MarkarthTempleInnerSanctum": InteriorType.CITY,
    "MarkarthTempleofDibella": InteriorType.CITY,
    "MarkarthTreasuryHouse": InteriorType.CITY,
    "MarkarthUnderStoneKeep": InteriorType.CITY,
    "MarkarthVlindrelHall": InteriorType.CITY,
    "MarkarthWarrens": InteriorType.UNDERCITY,
    "MarkarthWizardsQuarters01": InteriorType.CITY,
    "MarkarthWizardsQuarters02": InteriorType.CITY,
    "MarkarthWizardsQuarters03": InteriorType.CITY,
    "MehrunesDagonShrine": InteriorType.MISC,
    "MerryfairFarm": InteriorType.CITY,
    "Mistwatch01": InteriorType.DUNGEON_FORT,
    "Mistwatch02": InteriorType.DUNGEON_FORT,
    "Mistwatch03": InteriorType.DUNGEON_FORT,
    "MixwaterMillGilfresHouse": InteriorType.CITY,
    "MixwaterMillWorkersHouse": InteriorType.CITY,
    "MolagBalVoiceCell": InteriorType.MISC,
    "MorKhazgurCellar": InteriorType.UNDERCITY,
    "MorKhazgurLaraksLonghouse": InteriorType.MISC,
    "MorKhazgurMine": InteriorType.DUNGEON_CAVE,
    "MorthalAlvasHouse": InteriorType.CITY,
    "MorthalAlvasHouseCellar": InteriorType.UNDERCITY,
    "MorthalFalionsHouse": InteriorType.CITY,
    "MorthalGuardhouse": InteriorType.CITY,
    "MorthalGuardhouseJail": InteriorType.UNDERCITY,
    "MorthalHighmoonHall": InteriorType.CITY,
    "MorthalJorgenandLamisHouse": InteriorType.CITY,
    "MorthalMoorsideInn": InteriorType.CITY,
    "MorthalThaumaturgistsHut": InteriorType.CITY,
    "MorthalThonnirsHouse": InteriorType.CITY,
    "Morvunskar01": InteriorType.DUNGEON_FORT,
    "MovarthsLair01": InteriorType.DUNGEON_CAVE,
    "Mzinchaleft01": InteriorType.DUNGEON_DWEMER,
    "Mzinchaleft02": InteriorType.DUNGEON_DWEMER,
    "Mzinchaleft03": InteriorType.DUNGEON_DWEMER,
    "Mzulft01": InteriorType.DUNGEON_DWEMER,
    "Mzulft02": InteriorType.DUNGEON_DWEMER,
    "Mzulft03": InteriorType.DUNGEON_DWEMER,
    "Mzulft04z": InteriorType.DUNGEON_DWEMER,
    "NarzulburBasement": InteriorType.UNDERCITY,
    "NarzulburMauhulakhsLonghouse": InteriorType.MISC,
    "NchuandZel01": InteriorType.DUNGEON_DWEMER,
    "NchuandZel02": InteriorType.DUNGEON_DWEMER,
    "NchuandZel03": InteriorType.DUNGEON_DWEMER,
    "NchuandZel05": InteriorType.DUNGEON_DWEMER,
    "NchuandZel06": InteriorType.DUNGEON_DWEMER,
    "NightcallerTemple01": InteriorType.DUNGEON_FORT,
    "NightgateInn": InteriorType.CITY,
    "NightgateInnCellar": InteriorType.UNDERCITY,
    "NightingaleHall01": InteriorType.UNDERCITY,
    "NorthwatchKeep01": InteriorType.DUNGEON_FORT,
    "NorthwindMine01": InteriorType.DUNGEON_CAVE,
    "OLDBluePalaceWing01": InteriorType.MISC,
    "OldHroldanInn": InteriorType.CITY,
    "Orotheim01": InteriorType.DUNGEON_CAVE,
    "PelagiaFarm": InteriorType.CITY,
    "PinemoonCave01": InteriorType.DUNGEON_CAVE,
    "PinepeakCavern01": InteriorType.DUNGEON_CAVE,
    "Pinewatch01": InteriorType.MISC,
    "Pinewatch02": InteriorType.MISC,
    "PotemasCatacombs01": InteriorType.DUNGEON_UNDEAD,
    "PotemasCatacombs02": InteriorType.DUNGEON_UNDEAD,
    "PotemasCatacombs03": InteriorType.DUNGEON_UNDEAD,
    "PurewaterRun01": InteriorType.DUNGEON_CAVE,
    "Ragnvald01": InteriorType.DUNGEON_UNDEAD,
    "Ragnvald02": InteriorType.DUNGEON_UNDEAD,
    "Ragnvald03": InteriorType.DUNGEON_UNDEAD,
    "Raldbthar01": InteriorType.DUNGEON_DWEMER,
    "Raldbthar02": InteriorType.DUNGEON_DWEMER,
    "RannveigsFast01": InteriorType.DUNGEON_UNDEAD,
    "RavenscarHollow01": InteriorType.DUNGEON_CAVE,
    "ReachcliffCave01": InteriorType.DUNGEON_CAVE,
    "ReachwaterRock01": InteriorType.DUNGEON_UNDEAD,
    "ReachwindEyrie01": InteriorType.DUNGEON_DWEMER,
    "RebelsCairn01": InteriorType.DUNGEON_UNDEAD,
    "RedoransRetreat01": InteriorType.DUNGEON_CAVE,
    "RiftenBeeandBarb": InteriorType.CITY,
    "RiftenBeggarsRow": InteriorType.CITY,
    "RiftenBlackBriarManor": InteriorType.CITY,
    "RiftenBlackBriarMeadery": InteriorType.CITY,
    "RiftenBlacksmith": InteriorType.CITY,
    "RiftenBollisHouse": InteriorType.CITY,
    "RiftenElgrimsElixirs": InteriorType.CITY,
    "RiftenEsbernsVault": InteriorType.CITY,
    "RiftenFishery": InteriorType.CITY,
    "RiftenHaelgasBunkhouse": InteriorType.CITY,
    "RiftenHoneyside": InteriorType.CITY,
    "RiftenHonorhallOrphanage": InteriorType.CITY,
    "RiftenHouseofClanSnowShod": InteriorType.CITY,
    "RiftenHouseofMjolltheLioness": InteriorType.CITY,
    "RiftenJail01": InteriorType.UNDERCITY,
    "RiftenJail02": InteriorType.UNDERCITY,
    "RiftenMariseAravelsHouse": InteriorType.CITY,
    "RiftenMausoleum": InteriorType.CITY,
    "RiftenMercerFreyHouse": InteriorType.CITY,
    "RiftenMistveilBarracks": InteriorType.CITY,
    "RiftenMistveilKeep": InteriorType.CITY,
    "RiftenMistveilKeepJarlsChambers": InteriorType.CITY,
    "RiftenPawnedPrawn": InteriorType.CITY,
    "RiftenRaggedFlagon": InteriorType.CITY,
    "RiftenRatway01": InteriorType.CITY,
    "RiftenRatway02": InteriorType.CITY,
    "RiftenRomlynDrethsHouse": InteriorType.CITY,
    "RiftenStables": InteriorType.CITY,
    "RiftenTempleofMara": InteriorType.CITY,
    "RiftenThievesGuildHeadquarters": InteriorType.UNDERCITY,
    "RiftenValindorsHouse": InteriorType.CITY,
    "RiftenWarehouse": InteriorType.CITY,
    "RimerockBurrow01": InteriorType.DUNGEON_ICE,
    "RiverwoodAlvorsHouse": InteriorType.CITY,
    "RiverwoodFaendalsHouse": InteriorType.CITY,
    "RiverwoodGerdursHouse": InteriorType.CITY,
    "RiverwoodRiverwoodTrader": InteriorType.MISC,
    "RiverwoodSleepingGiantInn": InteriorType.CITY,
    "RiverwoodSvensHouse": InteriorType.CITY,
    "RobbersGorge01": InteriorType.MISC,
    "RoriksteadCowflopFarm": InteriorType.CITY,
    "RoriksteadFrostfruitInn": InteriorType.CITY,
    "RoriksteadLemkilsFarm": InteriorType.CITY,
    "RoriksteadRoriksManor": InteriorType.CITY,
    "Saarthal01": InteriorType.DUNGEON_UNDEAD,
    "Saarthal02": InteriorType.DUNGEON_UNDEAD,
    "SalviusFarmhouse": InteriorType.CITY,
    "SancreTorCatacombs": InteriorType.MISC,
    "SancreTorHallOfJudgement": InteriorType.MISC,
    "SancreTorMainHall": InteriorType.MISC,
    "SancreTorPrisons": InteriorType.UNDERCITY,
    "SancreTorSealedHalls": InteriorType.MISC,
    "SancreTorTiberSeptimShrine": InteriorType.MISC,
    "SarethiFarm": InteriorType.CITY,
    "SeptimusSignusOutpost": InteriorType.DUNGEON_ICE,
    "SerpentsBluffRedoubt01": InteriorType.MISC,
    "ShimmermistCave01": InteriorType.DUNGEON_CAVE,
    "ShimmermistCave02": InteriorType.DUNGEON_CAVE,
    "ShorsStoneFilnjarsHouse": InteriorType.CITY,
    "ShorsStoneOdfelsandGrogmarsHouse": InteriorType.CITY,
    "ShorsStoneRedbellyMine": InteriorType.DUNGEON_CAVE,
    "ShorsStoneSylgjasHouse": InteriorType.CITY,
    "ShriekwindBastion01": InteriorType.DUNGEON_UNDEAD,
    "ShroudHearthBarrow01": InteriorType.DUNGEON_UNDEAD,
    "ShroudHearthBarrow02": InteriorType.DUNGEON_UNDEAD,
    "ShroudedGrove01": InteriorType.DUNGEON_ICE,
    "SightlessPit01": InteriorType.DUNGEON_DWEMER,
    "SightlessPit02": InteriorType.DUNGEON_DWEMER,
    "SightlessPit03": InteriorType.DUNGEON_DWEMER,
    "SilentMoonsCamp01": InteriorType.DUNGEON_UNDEAD,
    "SilverdriftLair01": InteriorType.DUNGEON_UNDEAD,
    "Skuldafn01": InteriorType.DUNGEON_UNDEAD,
    "Skuldafn02": InteriorType.DUNGEON_UNDEAD,
    "Skuldafn04": InteriorType.DUNGEON_UNDEAD,
    "Skuldafn05": InteriorType.DUNGEON_UNDEAD,
    "SkyHavenTemple": InteriorType.DUNGEON_FORT,
    "SkyboundPass01": InteriorType.MISC,
    "SleepingTreeCamp01": InteriorType.DUNGEON_CAVE,
    "SnaplegCave01": InteriorType.DUNGEON_CAVE,
    "SnowShodFarm": InteriorType.CITY,
    "SnowVeilSanctum01": InteriorType.DUNGEON_UNDEAD,
    "SnowVeilSanctum02": InteriorType.DUNGEON_UNDEAD,
    "SolitudeAddvarsHouse": InteriorType.CITY,
    "SolitudeAngelinesAromatics": InteriorType.CITY,
    "SolitudeBardsCollege": InteriorType.CITY,
    "SolitudeBitsandPieces": InteriorType.CITY,
    "SolitudeBlackSmith": InteriorType.CITY,
    "SolitudeBluePalace": InteriorType.CITY,
    "SolitudeBrylingsHouse": InteriorType.CITY,
    "SolitudeCastleDour": InteriorType.CITY,
    "SolitudeCastleDourEmperorsTower": InteriorType.CITY,
    "SolitudeCastleDourTower": InteriorType.CITY,
    "SolitudeErikursHouse": InteriorType.CITY,
    "SolitudeEvetteSansHouse": InteriorType.CITY,
    "SolitudeFletcher": InteriorType.CITY,
    "SolitudeHalloftheDead": InteriorType.UNDERCITY,
    "SolitudeHalloftheDeadCatacombs": InteriorType.UNDERCITY,
    "SolitudeJail01": InteriorType.UNDERCITY,
    "SolitudeJalasHouse": InteriorType.CITY,
    "SolitudeJusticiarsHeadquarters": InteriorType.CITY,
    "SolitudeLighthouse": InteriorType.DUNGEON_ICE,
    "SolitudeProudspireManor": InteriorType.CITY,
    "SolitudeRadiantRaiment": InteriorType.CITY,
    "SolitudeRedWave": InteriorType.CITY,
    "SolitudeSawmill": InteriorType.CITY,
    "SolitudeStables": InteriorType.CITY,
    "SolitudeTempleoftheDivines": InteriorType.CITY,
    "SolitudeVittoriaVicisHouse": InteriorType.CITY,
    "SolitudeWinkingSkeever": InteriorType.CITY,
    "SoljundsSinkhole01": InteriorType.DUNGEON_CAVE,
    "SoljundsSinkholeMinersHouse": InteriorType.DUNGEON_CAVE,
    "SoulCairnZcell01": InteriorType.MISC,
    "Sovngarde01": InteriorType.CITY,
    "SteepfallBurrow01": InteriorType.DUNGEON_ICE,
    "StillbornCave01": InteriorType.DUNGEON_ICE,
    "StonehillsMine": InteriorType.DUNGEON_CAVE,
    "StonehillsSorlisHouse": InteriorType.CITY,
    "StonyCreekCave": InteriorType.DUNGEON_CAVE,
    "StonyCreekCave01": InteriorType.DUNGEON_CAVE,
    "SunderstoneGorge01": InteriorType.DUNGEON_CAVE,
    "SwindlersDen01": InteriorType.DUNGEON_CAVE,
    "SynodInteriorTemplate": InteriorType.MISC,
    "ThalmorEmbassy01": InteriorType.CITY,
    "ThalmorEmbassy02": InteriorType.CITY,
    "ThalmorEmbassy03": InteriorType.CITY,
    "ThalmorEmbassy04": InteriorType.CITY,
    "ThalmorEmbassy05": InteriorType.CITY,
    "TolvaldsCave01": InteriorType.DUNGEON_CAVE,
    "TolvaldsCave02": InteriorType.DUNGEON_CAVE,
    "TolvaldsCave03": InteriorType.DUNGEON_CAVE,
    "TowerOfMzark": InteriorType.DUNGEON_DWEMER,
    "TrevasWatch01": InteriorType.DUNGEON_FORT,
    "TrevasWatch02": InteriorType.DUNGEON_FORT,
    "TwilightSepulcher01": InteriorType.DUNGEON_UNDEAD,
    "TwilightSepulcher02": InteriorType.DUNGEON_UNDEAD,
    "UnownedCell": InteriorType.MISC,
    "Ustengrav01": InteriorType.DUNGEON_UNDEAD,
    "Ustengrav02": InteriorType.DUNGEON_UNDEAD,
    "UtteringHillsCave01": InteriorType.DUNGEON_ICE,
    "Valthume00": InteriorType.DUNGEON_UNDEAD,
    "Valthume01": InteriorType.DUNGEON_UNDEAD,
    "Valthume02": InteriorType.DUNGEON_UNDEAD,
    "VampireDungeon01": InteriorType.DUNGEON_UNDEAD,
    "Volskygge01": InteriorType.DUNGEON_UNDEAD,
    "Volskygge02": InteriorType.DUNGEON_UNDEAD,
    "Volunruud01": InteriorType.DUNGEON_UNDEAD,
    "Volunruud02": InteriorType.DUNGEON_UNDEAD,
    "WEMerchantChests": InteriorType.MISC,
    "WICourierCell": InteriorType.MISC,
    "WIDeadBodyCleanupCell": InteriorType.MISC,
    "WarehouseAmbushes": InteriorType.MISC,
    "WarehouseBookshelves": InteriorType.MISC,
    "WarehouseCarry": InteriorType.MISC,
    "WarehouseCrafting": InteriorType.MISC,
    "WarehouseFurniture": InteriorType.MISC,
    "WarehouseMasterPackage": InteriorType.MISC,
    "WarehouseMasterPackageMultiLink": InteriorType.MISC,
    "WarehousePrefabs": InteriorType.MISC,
    "WarehouseTraps": InteriorType.MISC,
    "WerewolfPreload": InteriorType.MISC,
    "WhistlingMine01": InteriorType.DUNGEON_CAVE,
    "WhiteRiverWatch01": InteriorType.DUNGEON_CAVE,
    "WhiterunAmrensHouse": InteriorType.CITY,
    "WhiterunArcadiasCauldron": InteriorType.CITY,
    "WhiterunBanneredMare": InteriorType.CITY,
    "WhiterunBelethorsGeneralGoods": InteriorType.CITY,
    "WhiterunBreezehome": InteriorType.CITY,
    "WhiterunCarlottaValentiasHouse": InteriorType.CITY,
    "WhiterunDragonsreach": InteriorType.CITY,
    "WhiterunDragonsreachBasement": InteriorType.UNDERCITY,
    "WhiterunDragonsreachJarlsQuarters": InteriorType.CITY,
    "WhiterunDrunkenHuntsman": InteriorType.CITY,
    "WhiterunGuardHouse": InteriorType.CITY,
    "WhiterunHalloftheDead": InteriorType.UNDERCITY,
    "WhiterunHalloftheDeadCatacombs": InteriorType.UNDERCITY,
    "WhiterunHeimskrsHouse": InteriorType.CITY,
    "WhiterunHouseBattleBorn": InteriorType.CITY,
    "WhiterunHouseGrayMane": InteriorType.CITY,
    "WhiterunJail02": InteriorType.UNDERCITY,
    "WhiterunJorrvaskr": InteriorType.CITY,
    "WhiterunJorrvaskrBasement": InteriorType.UNDERCITY,
    "WhiterunOlavatheFeeblesHouse": InteriorType.CITY,
    "WhiterunSeverioPelagiasHouse": InteriorType.CITY,
    "WhiterunStables": InteriorType.CITY,
    "WhiterunTempleofKynareth": InteriorType.CITY,
    "WhiterunUnderforge": InteriorType.CITY,
    "WhiterunUthgerdTheUnbrokensHouse": InteriorType.CITY,
    "WhiterunWarmaidens": InteriorType.CITY,
    "WhiterunYsoldasHouse": InteriorType.CITY,
    "WindhelmAretinoResidence": InteriorType.CITY,
    "WindhelmArgonianAssemblage": InteriorType.CITY,
    "WindhelmAtheronResidence": InteriorType.CITY,
    "WindhelmBelynHlaalusHouse": InteriorType.CITY,
    "WindhelmBlacksmith": InteriorType.CITY,
    "WindhelmBloodworks": InteriorType.CITY,
    "WindhelmBrunwulfFreeWintersHouse": InteriorType.CITY,
    "WindhelmCalixtosHouseofCuriosities": InteriorType.CITY,
    "WindhelmCandlehearthHall": InteriorType.CITY,
    "WindhelmClanShatterShieldOffice": InteriorType.CITY,
    "WindhelmEastEmpireCompany": InteriorType.CITY,
    "WindhelmHalloftheDead": InteriorType.UNDERCITY,
    "WindhelmHjerim": InteriorType.UNDERCITY,
    "WindhelmHouseofClanCruelSea": InteriorType.CITY,
    "WindhelmHouseofClanShatterShield": InteriorType.CITY,
    "WindhelmNewGnisisCornerclub": InteriorType.CITY,
    "WindhelmNiranyesHouse": InteriorType.CITY,
    "WindhelmNiranyesHouseBasement": InteriorType.UNDERCITY,
    "WindhelmPalaceUpstairs01": InteriorType.CITY,
    "WindhelmPalaceUpstairs02": InteriorType.CITY,
    "WindhelmPalaceoftheKings": InteriorType.CITY,
    "WindhelmSadrisUsedWares": InteriorType.CITY,
    "WindhelmStables": InteriorType.CITY,
    "WindhelmTempleofTalos": InteriorType.CITY,
    "WindhelmViolaGiordanosHouse": InteriorType.CITY,
    "WindhelmWarehouse": InteriorType.CITY,
    "WindhelmWhitePhial": InteriorType.CITY,
    "WinterholdCollegeArcanaeum": InteriorType.CITY,
    "WinterholdCollegeArchMageQuarters": InteriorType.CITY,
    "WinterholdCollegeHallofAttainment": InteriorType.CITY,
    "WinterholdCollegeHallofCountenance": InteriorType.CITY,
    "WinterholdCollegeHallofTheElements": InteriorType.CITY,
    "WinterholdCollegeMidden01": InteriorType.CITY,
    "WinterholdCollegeMidden02": InteriorType.CITY,
    "WinterholdJail": InteriorType.UNDERCITY,
    "WinterholdJarlsLonghouse": InteriorType.CITY,
    "WinterholdKorirshouse": InteriorType.CITY,
    "WinterholdRanmirshouse": InteriorType.CITY,
    "WinterholdTheFrozenHearth": InteriorType.CITY,
    "WinterholdTheFrozenHearthCellar": InteriorType.UNDERCITY,
    "WolfSkullCave02": InteriorType.DUNGEON_CAVE,
    "WolfskullCave01": InteriorType.DUNGEON_CAVE,
    "YngolBarrow01": InteriorType.DUNGEON_UNDEAD,
    "Yngvild01": InteriorType.DUNGEON_ICE,
    "Yngvild02": InteriorType.DUNGEON_ICE,
    "YsgramorsTomb01": InteriorType.DUNGEON_UNDEAD,
    "aaHea04backup": InteriorType.MISC,
    "aaaNewCave": InteriorType.DUNGEON_CAVE,
    "ccBGSSSE016Interior01": InteriorType.MISC,
    "ccBGSSSE016Interior02": InteriorType.MISC,
    "ccBGSSSE025RootDungeon": InteriorType.MISC,
    "ccBGSSSE043_Interior01": InteriorType.MISC,
    "ccEEJSSE003_Interior01": InteriorType.MISC,
    "ccEEJSSE004_Interior01": InteriorType.MISC,
    "ccMDRSSE001_Interior01": InteriorType.MISC,
    "ccPlaceholder01Interior01": InteriorType.MISC,
    "ccPlaceholder02Interior01": InteriorType.MISC,
    "ccPlaceholder03Interior01": InteriorType.MISC,
    "ccPlaceholder04Interior01": InteriorType.MISC,
    "ccPlaceholder05Interior01": InteriorType.MISC,
    "ccPlaceholder06Interior01": InteriorType.MISC,
    "ccPlaceholder07Interior01": InteriorType.MISC,
    "ccPlaceholder08Interior01": InteriorType.MISC,
    "ccPlaceholder09Interior01": InteriorType.MISC,
    "ccPlaceholder10Interior01": InteriorType.MISC,
    "ccPlaceholder11Interior01": InteriorType.MISC,
    "ccPlaceholder12Interior01": InteriorType.MISC,
    "ccPlaceholder13Interior01": InteriorType.MISC,
    "ccPlaceholder14Interior01": InteriorType.MISC,
    "ccPlaceholder15Interior01": InteriorType.MISC,
    "ccPlaceholder16Interior01": InteriorType.MISC,
    "ccPlaceholder17Interior01": InteriorType.MISC,
    "ccPlaceholder18Interior01": InteriorType.MISC,
    "ccPlaceholder19Interior01": InteriorType.MISC,
    "ccPlaceholder20Interior01": InteriorType.MISC,
    "ccPlaceholder21Interior01": InteriorType.MISC,
    "ccPlaceholder22Interior01": InteriorType.MISC,
    "ccPlaceholder23Interior01": InteriorType.MISC,
    "ccPlaceholder24Interior01": InteriorType.MISC,
    "ccPlaceholder25Interior01": InteriorType.MISC,
    "vampireDreamworld01": InteriorType.DUNGEON_UNDEAD,
    "vampireDreamworld02": InteriorType.DUNGEON_UNDEAD,
    "vampireDreamworld03": InteriorType.DUNGEON_UNDEAD,
}


@dataclass(kw_only=True)
class Cell:
    plugin: str  # Skyrim.esm
    name: str  # whiterundragonsreach
    id: str  # 000165A3


def get_cells() -> Iterable[Cell]:
    """
    Get the Cells.csv from "Export interior cell names" from xEdit for each plugin one by one,
    rename the files <my_plugin_file_stem>.<my_plugin_file_extension>_Cells.csv and put them
    in the Cells folder in this repo. Run this script from the base directory of this repo.

    standard_lighting_templates
     Cells
        ccBGSSSE001-Fish.esm_Cells.csv
        ccBGSSSE025-AdvDSGS.esm_Cells.csv
        ccQDRSSE001-SurvivalMode.esl_Cells.csv
        Dawnguard.esm_Cells.csv
        Dragonborn.esm_Cells.csv
        HearthFires.esm_Cells.csv
        Skyrim.esm_Cells.csv
        Update.esm_Cells.csv
     gen-slt

    """
    for file in Path("Cells").iterdir():
        contents = ""
        with open(file, "r") as f:
            contents = f.read()

        lines = contents.split("\n")

        for line in lines:
            if not line:
                continue
            if ";" not in line:
                continue

            entries = line.split(";")

            cell = Cell(
                plugin=file.name.split("_")[0],
                name=entries[3],
                id=entries[0].replace("[", "").replace("]", ""),
            )

            if cell.id == "FormID":
                continue

            if cell.name == "EditorID":
                continue

            if any(
                i in cell.name.lower()
                for i in [
                    "marker",
                    "test",
                    "holding",
                    "delete",
                    "navmeshgencell",
                    "qasmoke",
                    "utilitycell",
                ]
            ):
                continue

            yield cell


def get_contents_for(plugin: str, cells: Iterable[Cell]) -> dict[InteriorType, str]:
    """
    Given a plugin name like Skyrim.esm and an iterable over cells,
    return a dict where keys represent the type of the interior and
    the values represent the contents of the config file for that
    particular plugin and interior type. This config excludes cells
    that are handled by plugins other than the given one.
    """
    template = textwrap.dedent(
        f"""\
        ; EditorID
        filterByCells=EditorID
        :lightingTemplate=StandardLightingTemplates.esp|00801
        :setInheritanceFlags={", ".join(INHERIT_FLAGS)}
        :removeInheritanceFlags={", ".join(NO_INHERIT_FLAGS)}
        """
    )

    for flag, value in NO_INHERIT_FLAGS.items():
        template += f":{value}\n"

    template += "\n"

    result = defaultdict(str)
    for cell in cells:
        if cell.plugin != plugin:
            continue

        interior_type = INTERIOR_MAP.get(cell.name, InteriorType.MISC)

        config_string = template.replace("EditorID", cell.name)

        formatted_config_string = (
            config_string.replace("\n:", ":").replace(",\n", ", ").replace("=\n", "=")
        )

        result[interior_type] += formatted_config_string

    for k, v in result.items():
        result[k] = v.strip()

    return result


def write_conf(plugin: str, interior_type: InteriorType, contents: str) -> None:
    """
    Given a plugin name and the config contents for that plugin,
    find and write that plugin's conf file in-place.
    """
    home = Path.home()
    parent_path = (
        home
        / f".local/share/ammo/Skyrim Special Edition/mods/standard_lighting_templates/Data/SKSE/Plugins/SkyPatcher/cell/standard_lighting_templates/{interior_type.lower()}"
    )
    parent_path.mkdir(parents=True, exist_ok=True)

    with open(parent_path / f"{plugin}.ini", "w") as f:
        print(contents, file=f, flush=True)


if __name__ == "__main__":
    cells = sorted(get_cells(), key=lambda cell: cell.name)

    for plugin in SUPPORTED_PLUGINS:
        # The "Export interior cells" script in xEdit exports cells touched by a plugin,
        # even if that plugin didn't actually _create_ the cell. If a config file uses
        # filterByCells=<plugin>|<cell>
        # where that cell was created by a different plugin than the one specified, then
        # SkyPatcher will ctd after the main menu background shows but before the menu
        # is possible to interact with.
        # Therefore, use
        # filterByCells=<EditorID>
        # instead.
        plugin_cells = [cell for cell in cells if cell.plugin == plugin]
        content_map = get_contents_for(plugin, plugin_cells)
        for interior_type, contents in content_map.items():
            if not contents.strip():
                continue
            write_conf(plugin, interior_type, contents)
